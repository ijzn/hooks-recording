---
title: useState
order: 1
group:
  title: åŸºç¡€
  path: /basic
  order: 1
---


# useState

## ä½¿ç”¨è¯´æ˜
* useState å°±æ˜¯ä¸€ä¸ª Hook
* é€šè¿‡åœ¨å‡½æ•°ç»„ä»¶é‡Œè°ƒç”¨å®ƒæ¥ç»™ç»„ä»¶æ·»åŠ ä¸€äº›å†…éƒ¨ state,React ä¼šåœ¨é‡å¤æ¸²æŸ“æ—¶ä¿ç•™è¿™ä¸ª state
* useState ä¼šè¿”å›ä¸€å¯¹å€¼ï¼šå½“å‰çŠ¶æ€å’Œä¸€ä¸ªè®©ä½ æ›´æ–°å®ƒçš„å‡½æ•°ï¼Œä½ å¯ä»¥åœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­æˆ–å…¶ä»–ä¸€äº›åœ°æ–¹è°ƒç”¨è¿™ä¸ªå‡½æ•°ã€‚å®ƒç±»ä¼¼ class ç»„ä»¶çš„ this.setStateï¼Œä½†æ˜¯å®ƒä¸ä¼šæŠŠæ–°çš„ state å’Œæ—§çš„ state è¿›è¡Œåˆå¹¶
- useState å”¯ä¸€çš„å‚æ•°å°±æ˜¯åˆå§‹ state
  - è¿”å›ä¸€ä¸ª stateï¼Œä»¥åŠæ›´æ–° state çš„å‡½æ•°
  - åœ¨åˆå§‹æ¸²æŸ“æœŸé—´ï¼Œè¿”å›çš„çŠ¶æ€ (state) ä¸ä¼ å…¥çš„ç¬¬ä¸€ä¸ªå‚æ•° (initialState) å€¼ç›¸åŒ
  - setState å‡½æ•°ç”¨äºæ›´æ–° stateã€‚å®ƒæ¥æ”¶ä¸€ä¸ªæ–°çš„ state å€¼å¹¶å°†ç»„ä»¶çš„ä¸€æ¬¡é‡æ–°æ¸²æŸ“åŠ å…¥é˜Ÿåˆ—

## åŸºæœ¬ç”¨æ³•
```
const [state, setState] = useState(initialState);
```
### demo
<code src="./demo/demo1.jsx">

## æ¯æ¬¡æ¸²æŸ“éƒ½æ˜¯ç‹¬ç«‹çš„é—­åŒ…
- æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„ Props and State
- æ¯ä¸€æ¬¡æ¸²æŸ“éƒ½æœ‰å®ƒè‡ªå·±çš„äº‹ä»¶å¤„ç†å‡½æ•°
- alertä¼šâ€œæ•è·â€æˆ‘ç‚¹å‡»æŒ‰é’®æ—¶å€™çš„çŠ¶æ€ã€‚
- æˆ‘ä»¬çš„ç»„ä»¶å‡½æ•°æ¯æ¬¡æ¸²æŸ“éƒ½ä¼šè¢«è°ƒç”¨ï¼Œä½†æ˜¯æ¯ä¸€æ¬¡è°ƒç”¨ä¸­numberå€¼éƒ½æ˜¯å¸¸é‡ï¼Œå¹¶ä¸”å®ƒè¢«èµ‹äºˆäº†å½“å‰æ¸²æŸ“ä¸­çš„çŠ¶æ€å€¼
- åœ¨å•æ¬¡æ¸²æŸ“çš„èŒƒå›´å†…ï¼Œpropså’Œstateå§‹ç»ˆä¿æŒä¸å˜

<code src="./demo/demo2.jsx" />

## å‡½æ•°å¼æ›´æ–°
- å¦‚æœæ–°çš„ state éœ€è¦é€šè¿‡ä½¿ç”¨å…ˆå‰çš„ state è®¡ç®—å¾—å‡ºï¼Œé‚£ä¹ˆå¯ä»¥å°†å‡½æ•°ä¼ é€’ç»™ setStateã€‚è¯¥å‡½æ•°å°†æ¥æ”¶å…ˆå‰çš„ stateï¼Œå¹¶è¿”å›ä¸€ä¸ªæ›´æ–°åçš„å€¼
  - ä¸ç±»ç»„ä»¶ä¸­çš„ setState æ–¹æ³•ä¸åŒï¼ŒuseState ä¸ä¼šè‡ªåŠ¨åˆå¹¶æ›´æ–°å¯¹è±¡. è§£å†³æ–¹æ¡ˆï¼š
    - {...prevState, ...updatedValues} Object.assignä¹Ÿå¯ä»¥ã€‚
    - useReducer ï¼Œå®ƒæ›´é€‚åˆç®¡ç†åŒ…å«å¤šä¸ªå­å€¼çš„ state(çŠ¶æ€) å¯¹è±¡
```
setState(prevState => {
  // Object.assign ä¹Ÿæ˜¯å¯è¡Œçš„
  return {...prevState, ...updatedValues};
});
```

<code src="./demo/demo3.jsx">

## æƒ°æ€§åˆå§‹åŒ–
- initialState å‚æ•°æ˜¯åˆå§‹æ¸²æŸ“æœŸé—´ä½¿ç”¨çš„çŠ¶æ€ã€‚ åœ¨éšåçš„æ¸²æŸ“ä¸­ï¼Œå®ƒä¼šè¢«å¿½ç•¥äº†ã€‚ 
- å¦‚æœåˆå§‹çŠ¶æ€æ˜¯é«˜å¼€é”€çš„è®¡ç®—ç»“æœï¼Œåˆ™å¯ä»¥æ”¹ä¸ºæä¾›å‡½æ•°ï¼Œè¯¥å‡½æ•°ä»…åœ¨åˆå§‹æ¸²æŸ“æ—¶æ‰§è¡Œã€‚
- ğŸŒ°  è§å‡½æ•°å¼æ›´æ–°çš„demo
```
const [state, setState] = useState(() => {
  const initialState = someExpensiveComputation(props);
  return initialState;
});
```
## æ€§èƒ½ä¼˜åŒ–
### Object.is
- è°ƒç”¨ State Hook çš„æ›´æ–°å‡½æ•°å¹¶ä¼ å…¥å½“å‰çš„ state æ—¶ï¼ŒReact å°†è·³è¿‡å­ç»„ä»¶çš„æ¸²æŸ“åŠ effect çš„æ‰§è¡Œã€‚ï¼ˆReact ä½¿ç”¨ Object.is æ¯”è¾ƒç®—æ³• æ¥æ¯”è¾ƒ stateã€‚
  
<code src="./demo/demo4.jsx" />

### å‡å°‘æ¸²æŸ“æ¬¡æ•°
- æŠŠå†…è”å›è°ƒå‡½æ•°åŠä¾èµ–é¡¹æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥ useCallbackï¼Œå®ƒå°†è¿”å›è¯¥å›è°ƒå‡½æ•°çš„ memoized ç‰ˆæœ¬ï¼Œè¯¥å›è°ƒå‡½æ•°ä»…åœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰ä¼šæ›´æ–°
```
const memoizedCallback = useCallback(
  () => {
    doSomething(a, b);
  },
  [a, b],
);
```

- æŠŠåˆ›å»ºå‡½æ•°å’Œä¾èµ–é¡¹æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥ useMemoï¼Œå®ƒä»…ä¼šåœ¨æŸä¸ªä¾èµ–é¡¹æ”¹å˜æ—¶æ‰é‡æ–°è®¡ç®— memoized å€¼ã€‚è¿™ç§ä¼˜åŒ–æœ‰åŠ©äºé¿å…åœ¨æ¯æ¬¡æ¸²æŸ“æ—¶éƒ½è¿›è¡Œé«˜å¼€é”€çš„è®¡ç®—

```
const memoizedValue = useMemo(() => computeExpensiveValue(a, b), [a, b]);
```

 [useCallback ä¸ useMemo åŒºåˆ«](https://github.com/monsterooo/blog/issues/37)

- ç›¸åŒç‚¹ï¼š
  - ç¼“å­˜å‡½æ•°çš„å¼•ç”¨æˆ–å€¼
- ä¸åŒç‚¹
  - useCallback ç¼“å­˜çš„æ˜¯å‡½æ•°çš„å¼•ç”¨ã€‚
    - ä½¿ç”¨åœºæ™¯ï¼šä¼˜åŒ–å­ç»„ä»¶æ¸²æŸ“æ¬¡æ•°
  - useMemo ç¼“å­˜çš„æ˜¯è®¡ç®—æ•°æ®çš„å€¼
    - ä½¿ç”¨åœºæ™¯ï¼šä¼˜åŒ–é’ˆå¯¹äºå½“å‰ç»„ä»¶é«˜å¼€é”€çš„è®¡ç®—ï¼Œå…·æœ‰è®°å¿†åŠŸèƒ½


<code src="./demo/demo5.jsx">

